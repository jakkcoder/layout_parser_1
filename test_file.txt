import pandas as pd
from google.cloud import bigquery
import os

# Set the environment variable for Google Cloud credentials
os.environ["GOOGLE_APPLICATION_CREDENTIALS"] = "path/to/your/credentials.json"

# Load the CSV file into a DataFrame
csv_file_path = 'path/to/your/file.csv'
df = pd.read_csv(csv_file_path)

# Initialize a BigQuery client
client = bigquery.Client()

# Define the BigQuery details
project_id = 'your-gcp-project-id'
dataset_id = 'your_dataset'
table_id = 'your_table'
table_ref = f"{project_id}.{dataset_id}.{table_id}"

# Define the job configuration for loading the data
job_config = bigquery.LoadJobConfig(
    write_disposition=bigquery.WriteDisposition.WRITE_TRUNCATE,  # Options: WRITE_TRUNCATE, WRITE_APPEND, WRITE_EMPTY
)

# Load the DataFrame into BigQuery
job = client.load_table_from_dataframe(df, table_ref, job_config=job_config)

# Wait for the load job to complete
job.result()

print(f"Loaded {job.output_rows} rows into {table_ref}.")
