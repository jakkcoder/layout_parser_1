from google.cloud import bigquery
import json

# Define your project ID, dataset ID, and table ID
project_id = 'your_project_id'
dataset_id = 'your_dataset_id'
table_id = 'your_table_id'
table_full_id = f"{project_id}.{dataset_id}.{table_id}"

# Initialize a BigQuery client
client = bigquery.Client(project=project_id)

# Get the table schema
table = client.get_table(table_full_id)  # Make an API request.

# Convert the schema to a JSON representation
schema_json = [field.to_api_repr() for field in table.schema]

# Save the schema to a JSON file
with open('table_schema.json', 'w') as schema_file:
    json.dump(schema_json, schema_file, indent=2)

print(f"Schema for table {table_full_id} saved to table_schema.json")
