from google.cloud import bigquery

# Define table name
bq_schedule_table = 'PIPELINE_RUN_INFO'

# Define column names
bq_schedule_meta = ['COMMENT', 'CREATED_AT', 'DESCRIPTION', 'DP_IMAGE_VERSION', 'END_TIME', 'ID', 'NOTIFICATION_RECIPIENTS', 'PIPELINE_ID', 'PIPELINE_ZIP', 'PYTHON_VERSION', 'REQUEST_PACKAGE', 'RUN_ID', 'START_TIME', 'STATUS', 'STEP_NUM', 'UPDATE_TIME', 'VERSION']

# Define schema
bq_schedule_schema = [
    bigquery.SchemaField("COMMENT", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("CREATED_AT", "TIMESTAMP", mode="NULLABLE"),
    bigquery.SchemaField("DESCRIPTION", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("DP_IMAGE_VERSION", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("END_TIME", "TIMESTAMP", mode="NULLABLE"),
    bigquery.SchemaField("ID", "INTEGER", mode="NULLABLE"),
    bigquery.SchemaField("NOTIFICATION_RECIPIENTS", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("PIPELINE_ID", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("PIPELINE_ZIP", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("PYTHON_VERSION", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("REQUEST_PACKAGE", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("RUN_ID", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("START_TIME", "TIMESTAMP", mode="NULLABLE"),
    bigquery.SchemaField("STATUS", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("STEP_NUM", "INTEGER", mode="NULLABLE"),
    bigquery.SchemaField("UPDATE_TIME", "TIMESTAMP", mode="NULLABLE"),
    bigquery.SchemaField("VERSION", "STRING", mode="NULLABLE")
]

# Now you can use this schema when creating a BigQuery table
client = bigquery.Client()
table_id = "your_project.your_dataset.PIPELINE_RUN_INFO"
table = bigquery.Table(table_id, schema=bq_schedule_schema)

# Create the table in BigQuery
table = client.create_table(table)
print(f"Created table {table.project}.{table.dataset_id}.{table.table_id}")
