from google.cloud import logging

def query_bigquery_table_creation(dataset_id, table_id, project_id):
    # Construct the logging client
    client = logging.Client()

    # Construct the query
    filter_str = f"""
    resource.type="bigquery_resource"
    protoPayload.methodName="google.cloud.bigquery.v2.TableService.InsertTable"
    protoPayload.resourceName="projects/{project_id}/datasets/{dataset_id}/tables/{table_id}"
    """

    # Create a query to the Logging API
    for entry in client.list_entries(filter_=filter_str):
        proto_payload = entry.payload.get('protoPayload', {})
        principal_email = proto_payload.get('authenticationInfo', {}).get('principalEmail', 'No email found')
        print(f"Table {table_id} created by: {principal_email}")

# Usage
project_id = 'your-project-id'
dataset_id = 'your-dataset-id'
table_id = 'your-table-id'
query_bigquery_table_creation(dataset_id, table_id, project_id)
