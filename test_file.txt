from google.cloud import bigquery

# Define table name
bq_schedule_table = 'PIPELINE_RUN_INFO'

# Define column names
bq_schedule_meta = [
    'comment',
    'created_at',
    'description',
    'dp_image_version',
    'end_time',
    'id',
    'notification_recipients',
    'pipeline_id',
    'pipeline_zip',
    'python_version',
    'request_package',
    'run_id',
    'start_time',
    'status',
    'step_num',
    'update_time',
    'version'
]

# Define schema
bq_schedule_schema = [
    bigquery.SchemaField("comment", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("created_at", "TIMESTAMP", mode="NULLABLE"),
    bigquery.SchemaField("description", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("dp_image_version", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("end_time", "TIMESTAMP", mode="NULLABLE"),
    bigquery.SchemaField("id", "INTEGER", mode="NULLABLE"),
    bigquery.SchemaField("notification_recipients", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("pipeline_id", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("pipeline_zip", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("python_version", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("request_package", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("run_id", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("start_time", "TIMESTAMP", mode="NULLABLE"),
    bigquery.SchemaField("status", "STRING", mode="NULLABLE"),
    bigquery.SchemaField("step_num", "INTEGER", mode="NULLABLE"),
    bigquery.SchemaField("update_time", "TIMESTAMP", mode="NULLABLE"),
    bigquery.SchemaField("version", "STRING", mode="NULLABLE")
]

# Now you can use this schema when creating a BigQuery table
client = bigquery.Client()
table_id = "your_project.your_dataset.Pipeline_Run_Info"
table = bigquery.Table(table_id, schema=bq_schedule_schema)

# Create the table in BigQuery
table = client.create_table(table)
print(f"Created table {table.project}.{table.dataset_id}.{table.table_id}")
