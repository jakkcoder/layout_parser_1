import pandas as pd
import difflib

# Example lists from images
list1 = [
    "http://www.foxes-island.co.nz",
    "https://lotuseventdecor.com/simi-valley-floris...",
    "https://www.ajnhcs.com.au/",
    "https://tempercool.com.au/",
    "http://www.juliekaplanphoto.com",
    "https://delverecuit.com/",
    "www.globalmayatransport.com",
    "https://www.clockparts.com/high-torque-clock-m...",
    "http://www.angeldentalsupply.com",
    "https://perfectbuysvault.shop/",
    "https://kevin-atoms.tumblr.com/rss",
    "http://www.braysvillage.com",
    "https://www.patakainstitute.com",
    "https://www.tiktok.com@mijain237?_t=8oSzLOeqyAA...",
]

list2 = [
    "bbca1959.org",
    "www.ajnhcs.com.au",
    "www.vizineo.com",
    "www.corexpilates.com.au",
    "sikhtraditionculture.site",
    "perfectbuysvault.shop",
    "www.globalmayatransport.com",
    "www.patakainstitute.com",
    "delverecruit.com",
    "braysvillage.com",
    "www.foxes-island.co.nz",
    "www.juliekaplanphoto.com",
    "tempercool.com.au",
    "www.angeldentalsupply.com",
    "kevin-atoms.tumblr.com/rss",
]

# Convert lists to DataFrame
df1 = pd.DataFrame(list1, columns=['source_url'])
df2 = pd.DataFrame(list2, columns=['lookup'])

# Function to find best matches
def find_best_matches(df1, df2, column1, column2):
    matches = []
    for value in df1[column1]:
        best_match = difflib.get_close_matches(value, df2[column2], n=1, cutoff=0.1)
        matches.append(best_match[0] if best_match else None)
    df1['best_match'] = matches
    return df1

# Find best matches
merged_df = find_best_matches(df1, df2, 'source_url', 'lookup')

# Display the merged DataFrame
import ace_tools as tools; tools.display_dataframe_to_user(name="Merged URLs", dataframe=merged_df)

merged_df
